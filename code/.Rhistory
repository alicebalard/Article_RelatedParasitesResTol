#   coord_cartesian(ylim=c(0, 0.30)) +
#   theme(legend.position = "top") +
#   ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
pts
# ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
#   geom_line(aes(group = group)) +
#   facet_grid(.~infection_isolate) +
#   # geom_label_repel(aes(label = label), nudge_x = .1, na.rm = TRUE)+
#   geom_label_repel(aes(label = label),
#                    nudge_y = ifelse(pts$var == "y2", 1, -1), na.rm = TRUE)
#   geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
#   scale_color_manual(values = mycolors) +
#   scale_x_continuous("maximum million oocysts per gram of feces",
#                      breaks = seq(0, 5000000, 1000000),
#                      labels = seq(0, 5000000, 1000000)/1000000) +
#   scale_y_continuous(name = "maximum weight loss compared to day of infection",
#                      breaks = seq(0,0.3, 0.05),
#                      labels = scales::percent_format(accuracy = 5L)) +
#   geom_point(data = mydata, size = 4, alpha = .5)+
#   coord_cartesian(ylim=c(0, 0.30)) +
#   theme(legend.position = "top") +
#   ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_continuous("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
# Fig 3.
getFigRIT <- function(which){
# cowplot::plot_grid(plotResList[[which]] + theme(legend.position = "none"),
#                    plotImpList[[which]] + theme(legend.position = "none"),
#                    plotTolList[[which]]+ theme(legend.position = "none"),
#                    labels=c("A", "B", "C"), label_size = 20,nrow = 2,
#                    rel_widths = c(1, 1, 2))
cowplot::ggdraw() +
draw_plot(plotResList[[which]] + theme(legend.position = "none"), 0, .5, .49, .49) +
draw_plot(plotImpList[[which]] + theme(legend.position = "none"), .5, .5, .49, .49) +
draw_plot(plotTolList[[which]]+ theme(legend.position = "none"), 0, 0, .7, .49) +
draw_plot_label(c("A", "B", "C"), c(.01, .51, .01), c(1, 1, .5), size = 15)
}
listPlotsRIT <- lapply(c("full", "cons"), getFigRIT)
listPlotsRIT[1]
listPlotsRIT[2]
Fig3 <- listPlotsRIT[[1]]
Fig3
pdf(file = "../figures/Fig3_temp.pdf",
width = 10, height = 10)
Fig3
dev.off()
pdf(file = "../figures/SupplS2_part2_temp.pdf",
width = 10, height = 10)
listPlotsRIT[[2]]
dev.off()
Fig3
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_smooth(method = "lm", aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_continuous("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_smooth(method = "lm", aes(group = group), se = T) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_continuous("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_smooth(aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_continuous("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_continuous("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
# Fig 3.
getFigRIT <- function(which){
# cowplot::plot_grid(plotResList[[which]] + theme(legend.position = "none"),
#                    plotImpList[[which]] + theme(legend.position = "none"),
#                    plotTolList[[which]]+ theme(legend.position = "none"),
#                    labels=c("A", "B", "C"), label_size = 20,nrow = 2,
#                    rel_widths = c(1, 1, 2))
cowplot::ggdraw() +
draw_plot(plotResList[[which]] + theme(legend.position = "none"), 0, .5, .49, .49) +
draw_plot(plotImpList[[which]] + theme(legend.position = "none"), .5, .5, .49, .49) +
draw_plot(plotTolList[[which]]+ theme(legend.position = "none"), 0, 0, .7, .49) +
draw_plot_label(c("A", "B", "C"), c(.01, .51, .01), c(1, 1, .5), size = 15)
}
listPlotsRIT <- lapply(c("full", "cons"), getFigRIT)
listPlotsRIT[1]
listPlotsRIT[2]
Fig3 <- listPlotsRIT[[1]]
Fig3
pdf(file = "../figures/Fig3_temp.pdf",
width = 10, height = 10)
Fig3
dev.off()
pdf(file = "../figures/SupplS2_part2_temp.pdf",
width = 10, height = 10)
listPlotsRIT[[2]]
dev.off()
Fig3
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_log10("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_log10("maximum million oocysts per gram of feces")#,
# breaks = seq(0, 5000000, 1000000),
# labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
### Tolerance
get_plotT <- function(mypredTolSlopes, mydata){
# make line up to 5e6 OPG for plot
pts <- mypredTolSlopes
names(pts) <- "name"
pts <- data.frame(pts)
colnames(pts) <- gsub("name.", "", colnames(pts))
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste0(pts$Mouse_genotype, pts$infection_isolate))
pts$label <- pts$Mouse_genotype
levels(pts$label) <- as.character(c(1:8))
pts$Genotype <- paste0(pts$label, ". ", pts$Mouse_genotype)
pts$label[pts$max.OPG == 0] <- NA_character_
mydata$label <- mydata$Mouse_genotype
levels(mydata$label) <- as.character(c(1:8))
mydata$Genotype <- paste0(mydata$label, ". ", mydata$Mouse_genotype)
ggplot(pts, aes(x = max.OPG, y = relWL, col = Genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
geom_label(aes(label = label), nudge_x = -10, na.rm = TRUE)+
scale_color_manual(values = mycolors) +
scale_x_continuous("maximum million oocysts per gram of feces",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = scales::percent_format(accuracy = 5L)) +
geom_point(data = mydata, size = 4, alpha = .5)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top") +
ggtitle("Tolerance \n(slope of B (max weight loss) on A (max parasite load), per genotype)")
}
plotTolList <- list(full = get_plotT(predTolList["full"], art2SummaryDF),
cons = get_plotT(predTolList["cons"], art2SummaryDF_conservative))
plotTolList[1]
# Fig 3.
getFigRIT <- function(which){
# cowplot::plot_grid(plotResList[[which]] + theme(legend.position = "none"),
#                    plotImpList[[which]] + theme(legend.position = "none"),
#                    plotTolList[[which]]+ theme(legend.position = "none"),
#                    labels=c("A", "B", "C"), label_size = 20,nrow = 2,
#                    rel_widths = c(1, 1, 2))
cowplot::ggdraw() +
draw_plot(plotResList[[which]] + theme(legend.position = "none"), 0, .5, .49, .49) +
draw_plot(plotImpList[[which]] + theme(legend.position = "none"), .5, .5, .49, .49) +
draw_plot(plotTolList[[which]]+ theme(legend.position = "none"), 0, 0, .7, .49) +
draw_plot_label(c("A", "B", "C"), c(.01, .51, .01), c(1, 1, .5), size = 15)
}
testSignif(dataframe, "RES")$modfull
testSignif(art2SummaryDF, "RES")$modfull
plotResList[1]
######### STEP 1. Full model to see significance of all variables
art2SummaryDF$Batch
######### STEP 1. Full model to see significance of all variables
art2SummaryDF$Batch %in% c("B1", "B2")
######### STEP 1. Full model to see significance of all variables
art2SummaryDF[art2SummaryDF$Batch %in% c("B1", "B2"),]
######### STEP 1. Full model to see significance of all variables
LocAd <- art2SummaryDF[art2SummaryDF$Batch %in% c("B1", "B2"),]
Species <- art2SummaryDF[art2SummaryDF$Batch %in% c("B3", "B4"),]
table(LocAd$infection_isolate, LocAd$Mouse_genotype)
# drop unused levels
LocAd <- data.frame(lapply(LocAd, function(x) if (is.factor(x)) droplevels(x) else x))
table(LocAd$infection_isolate, LocAd$Mouse_genotype)
SpeciesComp <- art2SummaryDF[art2SummaryDF$Batch %in% c("B3", "B4"),]
SpeciesComp <- art2SummaryDF[art2SummaryDF$Batch %in% c("B3", "B4"),]
# drop unused levels
SpeciesComp <- data.frame(lapply(SpeciesComp, function(x) if (is.factor(x)) droplevels(x) else x))
table(SpeciesComp$infection_isolate, SpeciesComp$Mouse_genotype)
listbyQuestion <- list(LocAd, SpeciesComp)
### Res
lapply(listbyQuestion, function(x){testSignif(x,"RES")$LRT}) # all +interactions signif 0.02
lapply(listbyQuestion, function(x){testSignif(x,"RES_ZI")$LRT}) # all +interactions signif 0.02
### Res
lapply(listbyQuestion, function(x){testSignif(x,"RES")$LRT}) # all +interactions signif 0.02
testSignifWithinParas(SpeciesComp, "RES_ZI")
testSignif(SpeciesComp, "RES_ZI")
### Imp
lapply(listbyQuestion, function(x){testSignif(x,"IMP")$LRT}) # diff parasite + mouse
### Tol
lapply(listbyQuestion, function(x){testSignif(x,"TOL")$LRT}) # mouse signif
### Res
testSignif(LocAd,"RES")
plot_model(testSignif(LocAd,"RES")$mod, type = "int")
### Res
testSignif(LocAd,"RES"); plot_model(testSignif(LocAd,"RES")$mod, type = "int")
testSignif(SpeciesComp, "RES_ZI"); plot_model(testSignif(SpeciesComp,"RES_ZI")$mod, type = "int")
### Imp
testSignif(LocAd,"IMP"); plot_model(testSignif(LocAd,"IMP")$mod, type = "int")
testSignif(SpeciesComp, "IMP"); plot_model(testSignif(SpeciesComp,"IMP")$mod, type = "int")
### Tol
testSignif(LocAd,"TOL"); plot_model(testSignif(LocAd,"TOL")$mod, type = "int")
### Tol
testSignif(LocAd,"TOL"); plot_model(testSignif(LocAd,"TOL")$mod)
table(art2SummaryDF$infection_isolate, art2SummaryDF$Mouse_genotype)
