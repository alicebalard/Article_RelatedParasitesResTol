scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = art2al_SUMdf, size = 4, pch = 3)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
T1
T1 <- ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 500000),
labels = seq(0, 5000000, 500000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = art2al_SUMdf, size = 4, pch = 3)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
T1
## Means & 95% CI of each slope
T2 <- ggplot(predTolSlopes, aes(x = infection_isolate, y = predicted, col = Mouse_genotype)) +
geom_point(size = 4, position = position_dodge(width = .5)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1,
position = position_dodge(width = .5)) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
name = "(predicted) relative weight loss per million OPG") +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
theme(legend.position = "top")
T2
FigTOL <- cowplot::plot_grid(T1, T2,
labels=c("A", "B"), label_size = 20)
FigTOL
pdf(file = "../figures/Fig4.pdf",
width = 9, height = 9)
FigTOL
dev.off()
dev.off()
dev.off()
pdf(file = "../figures/Fig4.pdf",
width = 9, height = 9)
FigTOL
dev.off()
FigTOL
pdf(file = "../figures/Fig4.pdf",
width = 12, height = 6)
FigTOL
dev.off()
# T1 <-
ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 500000),
labels = seq(0, 5000000, 500000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = art2al_SUMdf, size = 4, pch = 1)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
T1 <- ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 500000),
labels = seq(0, 5000000, 500000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = art2al_SUMdf, size = 4, pch = 1)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
T1
## Means & 95% CI of each slope
T2 <- ggplot(predTolSlopes, aes(x = infection_isolate, y = predicted, col = Mouse_genotype)) +
geom_point(size = 4, position = position_dodge(width = .5)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1,
position = position_dodge(width = .5)) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
name = "(predicted) relative weight loss per million OPG") +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
theme(legend.position = "top")
T2
FigTOL <- cowplot::plot_grid(T1, T2,
labels=c("A", "B"), label_size = 20)
pdf(file = "../figures/Fig4.pdf",
width = 12, height = 6)
FigTOL
dev.off()
T1 <- ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = art2al_SUMdf, size = 4, pch = 1)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
T1
## Means & 95% CI of each slope
T2 <- ggplot(predTolSlopes, aes(x = infection_isolate, y = predicted, col = Mouse_genotype)) +
geom_point(size = 4, position = position_dodge(width = .5)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1,
position = position_dodge(width = .5)) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
name = "(predicted) relative weight loss per million OPG") +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
theme(legend.position = "top")
T2
FigTOL <- cowplot::plot_grid(T1, T2,
labels=c("A", "B"), label_size = 20)
pdf(file = "../figures/Fig4.pdf",
width = 12, height = 6)
FigTOL
dev.off()
########################################
### Second part: assessing tolerance ###
########################################
toleranceAnalysis <- function(dataset){
modfull <- lm(relWL ~ 0 + max.OPG : (infection_isolate * Mouse_genotype), data = dataset)
modNOmouse <- lm(relWL ~ 0 + max.OPG : (infection_isolate), data = dataset)
modNOisolate <- lm(relWL ~ 0 + max.OPG : (Mouse_genotype), data = dataset)
modNOint <- lm(relWL ~ 0 + max.OPG : (infection_isolate + Mouse_genotype), data = dataset)
testIsolate <- homemadeGtest(modfull, modNOisolate)
# [1] "G=30.2 ,df=8 ,p=0.000197"
testMouse <- homemadeGtest(modfull, modNOmouse)
# [1] "G=30.6 ,df=9 ,p=0.000341"
testInteraction <- homemadeGtest(modfull, modNOint)
# [1] "G=24 ,df=6 ,p=0.000513"
# Calculate slopes for each group:
predTolSlopes <- ggpredict(modfull, terms = c("Mouse_genotype", "infection_isolate"), condition = c(max.OPG = 1000000))
## And plot
predTolSlopes <- data.frame(predTolSlopes)
names(predTolSlopes)[names(predTolSlopes) %in% c("x", "group")] <- c("Mouse_genotype", "infection_isolate")
# make line up to 5e6 OPG for plot
pts <- predTolSlopes
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste(pts$Mouse_genotype, pts$infection_isolate, sep = "_"))
T1 <- ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = dataset, size = 4, pch = 1)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
## Means & 95% CI of each slope
T2 <- ggplot(predTolSlopes, aes(x = infection_isolate, y = predicted, col = Mouse_genotype)) +
geom_point(size = 4, position = position_dodge(width = .5)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1,
position = position_dodge(width = .5)) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
name = "(predicted) relative weight loss per million OPG") +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
theme(legend.position = "top")
FigTOL <- cowplot::plot_grid(T1, T2,
labels=c("A", "B"), label_size = 20)
return(list(testIsolate, testMouse, testInteraction, predTolSlopes, FigTOL))
}
toleranceAnalysis(dataset = art2al_SUMdf)
T <- toleranceAnalysis(dataset = art2al_SUMdf)
tolAll <- toleranceAnalysis(dataset = art2al_SUMdf)
View(tolAll)
return(list(testIsolate, testMouse, testInteraction, predTolSlopes, FigTOL = FigTOL))
########################################
### Second part: assessing tolerance ###
########################################
toleranceAnalysis <- function(dataset){
modfull <- lm(relWL ~ 0 + max.OPG : (infection_isolate * Mouse_genotype), data = dataset)
modNOmouse <- lm(relWL ~ 0 + max.OPG : (infection_isolate), data = dataset)
modNOisolate <- lm(relWL ~ 0 + max.OPG : (Mouse_genotype), data = dataset)
modNOint <- lm(relWL ~ 0 + max.OPG : (infection_isolate + Mouse_genotype), data = dataset)
testIsolate <- homemadeGtest(modfull, modNOisolate)
# [1] "G=30.2 ,df=8 ,p=0.000197"
testMouse <- homemadeGtest(modfull, modNOmouse)
# [1] "G=30.6 ,df=9 ,p=0.000341"
testInteraction <- homemadeGtest(modfull, modNOint)
# [1] "G=24 ,df=6 ,p=0.000513"
# Calculate slopes for each group:
predTolSlopes <- ggpredict(modfull, terms = c("Mouse_genotype", "infection_isolate"), condition = c(max.OPG = 1000000))
## And plot
predTolSlopes <- data.frame(predTolSlopes)
names(predTolSlopes)[names(predTolSlopes) %in% c("x", "group")] <- c("Mouse_genotype", "infection_isolate")
# make line up to 5e6 OPG for plot
pts <- predTolSlopes
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste(pts$Mouse_genotype, pts$infection_isolate, sep = "_"))
T1 <- ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = dataset, size = 4, pch = 1)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
## Means & 95% CI of each slope
T2 <- ggplot(predTolSlopes, aes(x = infection_isolate, y = predicted, col = Mouse_genotype)) +
geom_point(size = 4, position = position_dodge(width = .5)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1,
position = position_dodge(width = .5)) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
name = "(predicted) relative weight loss per million OPG") +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
theme(legend.position = "top")
FigTOL <- cowplot::plot_grid(T1, T2,
labels=c("A", "B"), label_size = 20)
return(list(testIsolate = testIsolate, testMouse = testMouse, testInteraction = testInteraction,
predTolSlopes = predTolSlopes, FigTOL = FigTOL))
}
tolAll <- toleranceAnalysis(dataset = art2al_SUMdf)
tolAl
tolAll$FigTOL
pdf(file = "../figures/Fig4.pdf",
width = 12, height = 6)
tolAll$FigTOL
dev.off()
### with full dataset
tolAll <- toleranceAnalysis(dataset = art2al_SUMdf)
pdf(file = "../figures/Fig4.pdf",
width = 12, height = 6)
tolAll$FigTOL
dev.off()
### with conservative dataset
tol77mice <- toleranceAnalysis(dataset = SUBsummaryDF77mice)
tol77mice$FigTOL
e
e
pdf(file = "../figures/tol77mice.pdf",
width = 12, height = 6)
### with conservative dataset
tol77mice <- toleranceAnalysis(dataset = SUBsummaryDF77mice)
pdf(file = "../figures/tol77mice.pdf",
width = 12, height = 6)
tol77mice$FigTOL
dev.off()
tolAll$FigTOL
tol77mice$FigTOL
tolAll$predTolSlopes
tolAll$FigTOL
tolAll$FigTOL
tol77mice$FigTOL
tolAll$FigTOL
T1
########################################
### Second part: assessing tolerance ###
########################################
toleranceAnalysis <- function(dataset){
modfull <- lm(relWL ~ 0 + max.OPG : (infection_isolate * Mouse_genotype), data = dataset)
modNOmouse <- lm(relWL ~ 0 + max.OPG : (infection_isolate), data = dataset)
modNOisolate <- lm(relWL ~ 0 + max.OPG : (Mouse_genotype), data = dataset)
modNOint <- lm(relWL ~ 0 + max.OPG : (infection_isolate + Mouse_genotype), data = dataset)
testIsolate <- homemadeGtest(modfull, modNOisolate)
# [1] "G=30.2 ,df=8 ,p=0.000197"
testMouse <- homemadeGtest(modfull, modNOmouse)
# [1] "G=30.6 ,df=9 ,p=0.000341"
testInteraction <- homemadeGtest(modfull, modNOint)
# [1] "G=24 ,df=6 ,p=0.000513"
# Calculate slopes for each group:
predTolSlopes <- ggpredict(modfull, terms = c("Mouse_genotype", "infection_isolate"), condition = c(max.OPG = 1000000))
## And plot
predTolSlopes <- data.frame(predTolSlopes)
names(predTolSlopes)[names(predTolSlopes) %in% c("x", "group")] <- c("Mouse_genotype", "infection_isolate")
# make line up to 5e6 OPG for plot
pts <- predTolSlopes
pts$predicted <- pts$predicted*5
pts$relWL_OPGnull <- 0
names(pts)[names(pts) %in% c("predicted")] <- "relWL_5MOPG"
pts <- melt(pts, measure.vars = c("relWL_OPGnull", "relWL_5MOPG"))
names(pts)[names(pts) %in% c("variable", "value")] <- c("max.OPG", "relWL")
pts$max.OPG <- as.character(pts$max.OPG)
pts$max.OPG[pts$max.OPG %in% "relWL_OPGnull"] <- "0"
pts$max.OPG[pts$max.OPG %in% "relWL_5MOPG"] <- "5e6"
pts$max.OPG <- as.numeric(pts$max.OPG)
pts$group <- factor(paste(pts$Mouse_genotype, pts$infection_isolate, sep = "_"))
T1 <- ggplot(pts, aes(x = max.OPG, y = relWL, col = Mouse_genotype)) +
geom_line(aes(group = group)) +
facet_grid(.~infection_isolate) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_continuous("maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 5000000, 1000000),
labels = seq(0, 5000000, 1000000)/1000000) +
scale_y_continuous(name = "maximum weight loss compared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
geom_point(data = dataset, size = 4, pch = 1)+
coord_cartesian(ylim=c(0, 0.30)) +
theme(legend.position = "top")
## Means & 95% CI of each slope
T2 <- ggplot(predTolSlopes, aes(x = infection_isolate, y = predicted, col = Mouse_genotype)) +
geom_point(size = 4, position = position_dodge(width = .5)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1,
position = position_dodge(width = .5)) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
name = "(predicted) relative weight loss per million OPG") +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
theme(legend.position = "top")
FigTOL <- cowplot::plot_grid(T1, T2,
labels=c("A", "B"), label_size = 20)
return(list(testIsolate = testIsolate, testMouse = testMouse, testInteraction = testInteraction,
predTolSlopes = predTolSlopes, T1 = T1, T2 = T2, FigTOL = FigTOL))
}
### with full dataset
tolAll <- toleranceAnalysis(dataset = art2al_SUMdf)
tolAll$T1
### with conservative dataset
tol77mice <- toleranceAnalysis(dataset = SUBsummaryDF77mice)
tol77mice$T1
tolAll$T1
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
mydatx
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydatx <- data.frame(mydatx)
names(mydatx)[names(mydatx)%in% "x"] <- "infection_isolate"
names(mydatx)[names(mydatx)%in% "group"] <- "Mouse_genotype"
mydatx
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
mydaty
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_relWL")
mydatx <- data.frame(mydatx)
names(mydatx)[names(mydatx)%in% "x"] <- "infection_isolate"
names(mydatx)[names(mydatx)%in% "group"] <- "Mouse_genotype"
mydaty
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_relWL")
mydaty <- data.frame(mydaty)
names(mydaty)[names(mydaty)%in% "x"] <- "infection_isolate"
names(mydaty)[names(mydaty)%in% "group"] <- "Mouse_genotype"
mydaty
mydaty$predicted_relWL <- mydaty$predicted_relWL - 0.01
mydaty
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_relWL")
mydaty <- data.frame(mydaty)
names(mydaty)[names(mydaty)%in% "x"] <- "infection_isolate"
names(mydaty)[names(mydaty)%in% "group"] <- "Mouse_genotype"
mydaty$predicted_relWL <- mydaty$predicted_relWL - 0.01
mydaty$conf.low_relWL <- mydaty$conf.low_relWL - 0.01
mydaty$conf.high_relWL <- mydaty$conf.high_relWL - 0.01
########## Average per group - plot
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydatx <- data.frame(mydatx)
names(mydatx)[names(mydatx)%in% "x"] <- "infection_isolate"
names(mydatx)[names(mydatx)%in% "group"] <- "Mouse_genotype"
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_relWL")
mydaty <- data.frame(mydaty)
names(mydaty)[names(mydaty)%in% "x"] <- "infection_isolate"
names(mydaty)[names(mydaty)%in% "group"] <- "Mouse_genotype"
# remove the 0.01 added for model
mydaty$predicted_relWL <- mydaty$predicted_relWL - 0.01
########## Average per group - plot
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydatx <- data.frame(mydatx)
names(mydatx)[names(mydatx)%in% "x"] <- "infection_isolate"
names(mydatx)[names(mydatx)%in% "group"] <- "Mouse_genotype"
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_relWL")
mydaty <- data.frame(mydaty)
names(mydaty)[names(mydaty)%in% "x"] <- "infection_isolate"
names(mydaty)[names(mydaty)%in% "group"] <- "Mouse_genotype"
# remove the 0.01 added for model
mydaty$predicted_relWL <- mydaty$predicted_relWL - 0.01
mydaty$conf.low_relWL <- mydaty$conf.low_relWL - 0.01
mydaty$conf.high_relWL <- mydaty$conf.high_relWL - 0.01
d <- merge(mydatx, mydaty)
figCoupl <- ggplot(d, aes(x = predicted_OPG, y = value,col = Mouse_genotype)) +
geom_point(size = 4)+
geom_errorbar(aes(ymin = down, ymax = up), width = .1) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), width = .1,
position = position_dodge(width = .5)) +
coord_cartesian(ylim=c(-0.3e-7,4.5e-7))+
scale_y_continuous(name = "slope of relative weight loss on OPG (inverse of tolerance)")+
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
facet_grid(.~infection_isolate)
figCoupl
# figCoupl <-
ggplot(d, aes(x = predicted_OPG, y = value,col = Mouse_genotype)) +
geom_point(size = 4)
# figCoupl <-
ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4)
figCoupl <- ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4)
figCoupl <- ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), width = .1) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), width = .1,
position = position_dodge(width = .5)) +
coord_cartesian(ylim=c(-0.3e-7,4.5e-7))+
scale_y_continuous(name = "slope of relative weight loss on OPG (inverse of tolerance)")+
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
facet_grid(.~infection_isolate)
figCoupl
figCoupl <- ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) #+
# figCoupl <-
ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) #+
# figCoupl <-
ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), width = .1) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), width = .1,
position = position_dodge(width = .5))# +
# figCoupl <-
ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), width = .1) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), width = .1,
position = position_dodge(width = .5)) +
# coord_cartesian(ylim=c(-0.3e-7,4.5e-7))+
# scale_y_continuous(name = "relative weight loss on OPG (inverse of tolerance)")+
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) #+
# figCoupl <-
ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), width = .1) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), width = .1,
position = position_dodge(width = .5)) +
# coord_cartesian(ylim=c(-0.3e-7,4.5e-7))+
# scale_y_continuous(name = "relative weight loss on OPG (inverse of tolerance)")+
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
facet_grid(.~infection_isolate)
figCoupl <- ggplot(d, aes(x = predicted_OPG, y = predicted_relWL,col = Mouse_genotype)) +
geom_point(size = 4) +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), width = .1) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), width = .1,
position = position_dodge(width = .5)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
facet_grid(.~infection_isolate)
figCoupl
