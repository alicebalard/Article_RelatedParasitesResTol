# Resistance
testSignif(art2al_SUMdf, "RES", "SPECIES")
testSignif(SUBsummaryDF77mice, "RES", "SPECIES")
testSignif(art2al_SUMdf, "RES", "STRAINS")
testSignif(SUBsummaryDF77mice, "RES", "STRAINS")
# Impact
testSignif(art2al_SUMdf, "IMP", "SPECIES")
testSignif(SUBsummaryDF77mice, "IMP", "SPECIES")
testSignif(art2al_SUMdf, "IMP", "STRAINS")
testSignif(SUBsummaryDF77mice, "IMP", "STRAINS") ####### !!!
## Translation of 1% because Weibull doesn't support nul data
coef(testSignif(art2al_SUMdf, "IMP", "SPECIES")$modfull)
coefImp <- exp(coef(testSignif(art2al_SUMdf, "IMP", "SPECIES")$modfull))
coefImp[1] - 0.01# Efer-MmD: 6.1%
coefImp[1] * coefImp[2] - 0.01 # Efal-MmD: 9.3%
coefImp[1] * coefImp[3] - 0.01# Efer-Mmm: 8.3%
coefImp[1] * coefImp[2] * coefImp[3] * coefImp[4] -0.01 # Efal-Mmm: 18.7%
# to avoid running these long test all the time
doYouRun = "keepit"
if (doYouRun == "foncebebe"){
# Resistance
testPostHoc(art2al_SUMdf, "RES", "SPECIES")
testPostHoc(SUBsummaryDF77mice, "RES", "SPECIES")
testPostHoc(art2al_SUMdf, "RES", "STRAINS")
testPostHoc(SUBsummaryDF77mice, "RES", "STRAINS")
# Impact
testPostHoc(art2al_SUMdf, "IMP", "SPECIES")
testPostHoc(SUBsummaryDF77mice, "IMP", "SPECIES")
testPostHoc(art2al_SUMdf, "IMP", "STRAINS")
testPostHoc(SUBsummaryDF77mice, "IMP", "STRAINS")
}
#################
## save output ##
#################
doYouSave = "foncebebe"
if (doYouSave == "foncebebe"){
# Resistance
write.csv(getMatrixPostHoc(testPostHoc(art2al_SUMdf, "RES", "SPECIES")),
"../figures/posthocResSPECIES.csv")
write.csv(getMatrixPostHoc(testPostHoc(SUBsummaryDF77mice, "RES", "SPECIES")),
"../figures/posthocResSPECIES_77mice.csv")
write.csv(getMatrixPostHoc(testPostHoc(art2al_SUMdf, "RES", "STRAINS")),
"../figures/posthocResSTRAINS.csv")
write.csv(getMatrixPostHoc(testPostHoc(SUBsummaryDF77mice, "RES", "STRAINS")),
"../figures/posthocResSTRAINS_77mice.csv")
# Impact
write.csv(getMatrixPostHoc(testPostHoc(art2al_SUMdf, "IMP", "SPECIES")),
"../figures/posthocImpSPECIES.csv")
write.csv(getMatrixPostHoc(testPostHoc(SUBsummaryDF77mice, "IMP", "SPECIES")),
"../figures/posthocImpSPECIES_77mice.csv")
write.csv(getMatrixPostHoc(testPostHoc(art2al_SUMdf, "IMP", "STRAINS")),
"../figures/posthocImpSTRAINS.csv")
write.csv(getMatrixPostHoc(testPostHoc(SUBsummaryDF77mice, "IMP", "STRAINS")),
"../figures/posthocImpSTRAINS_77mice.csv")
}
##########
## plot ##
##########
## To add Ns on top of bars
getNs <- function(proxy, df, groupMus = "Mouse_genotype", groupPar = "infection_isolate"){
noNA = df[!is.na(df[[proxy]]),]
noNA$groupMus = noNA[[groupMus]]
noNA$groupPar = noNA[[groupPar]]
tab = table(noNA$groupPar, noNA$groupMus)
Ns = as.character(as.vector(t(tab)[as.vector(t(tab))!=0]))
return(Ns)
}
############
## Resistance
# plot marginal effects of interaction terms
posx.1 <- c(0.9,1.1, 1.9,2.1)
get_plotR_SPECIES <- function(dataframe){
plot_model(testSignif(dataframe, "RES", "SPECIES")$modfull,
type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Maximum parasite load \n(mean and 95%CI)") +
scale_y_continuous("(predicted) maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 2500000, 500000),
labels = seq(0, 2500000, 500000)/1000000)+
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=90000,label=getNs("max.OPG", dataframe,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
}
# plot marginal effects of interaction terms by isolates & strains
posx.2 <- c(0.8+c(0,1/8,2/8,3/8),1.8+c(0,1/8,2/8,3/8),2.8+c(0,1/8,2/8,3/8))
get_plotR_STRAINS <- function(dataframe){
plot_model(testSignif(dataframe, "RES", "STRAINS")$modfull,
type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_y_continuous("(predicted) maximum oocysts per gram of feces (x10e6)",
breaks = seq(0, 3500000, 500000),
labels = seq(0, 3500000, 500000)/1000000)+
ggtitle("Maximum parasite load \n(mean and 95%CI)") +
xlab("Eimeria isolate") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.2,y=120000,label=getNs("max.OPG", dataframe)),vjust=0)
}
plotR_SPECIES <- get_plotR_SPECIES(art2al_SUMdf)
plotR_SPECIES
plotR_SPECIES_77mice <- get_plotR_SPECIES(SUBsummaryDF77mice)
plotR_SPECIES_77mice
plotR_STRAINS <- get_plotR_STRAINS(art2al_SUMdf)
plotR_STRAINS
plotR_STRAINS_77mice <- get_plotR_STRAINS(SUBsummaryDF77mice)
plotR_STRAINS_77mice
## NB: art2al_SUMdf$impact <- art2al_SUMdf$relWL + 0.01
art2al_SUMdf %>%
group_by(Mouse_subspecies, Eimeria_species) %>%
summarise(meanImp = mean(impact, na.rm = T))
## NB. translate back 0.01
transValuesImp <- seq(0.01,0.31, 0.05)
as.character(transValuesImp - 0.01)
realValuesImpLabels <- c("0%", "5%", "10%", "15%", "20%", "25%", "30%")
get_plotI_SPECIES <- function(dataframe){
plot_model(testSignif(dataframe, "IMP", "SPECIES")$modfull,
type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue","red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ggtitle("Maximum weight loss \n(mean and 95%CI)") +
scale_y_continuous(breaks = transValuesImp, labels = realValuesImpLabels,
name = "(predicted) maximum weight loss compared to day of infection")+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=0,label=getNs("relWL", dataframe,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
}
plotI_SPECIES <- get_plotI_SPECIES(art2al_SUMdf)
plotI_SPECIES
plotI_SPECIES_77mice <- get_plotI_SPECIES(SUBsummaryDF77mice)
plotI_SPECIES_77mice
get_plotI_STRAINS <- function(dataframe){
plot_model(testSignif(dataframe, "IMP", "STRAINS")$modfull,
type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
xlab("Eimeria isolate") +
ggtitle("Maximum weight loss \n(mean and 95%CI)") +
scale_y_continuous(breaks = transValuesImp, labels = realValuesImpLabels,
name = "(predicted) maximum weight loss compared to day of infection")+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.2,y=0,label=getNs("relWL", dataframe)),vjust=0)
}
plotI_STRAINS  <- get_plotI_STRAINS(art2al_SUMdf)
plotI_STRAINS
plotI_STRAINS_77mice <- get_plotI_STRAINS(SUBsummaryDF77mice)
plotI_STRAINS_77mice
# Fig 3.
Fig3 <- cowplot::plot_grid(plotR_SPECIES + theme(legend.position = "none"),
plotI_SPECIES + theme(legend.position = "none"),
plotR_SPECIES,
labels=c("A", "B", "C"), label_size = 20)
Fig3
pdf(file = "../figures/Fig3.pdf",
width = 9, height = 9)
Fig3
dev.off()
## Fig 4
Fig4 <-  cowplot::plot_grid(
plotR_STRAINS + theme(legend.position = "none"),
plotI_STRAINS + theme(legend.position = "none"),
plotR_STRAINS,
labels=c("A", "B", "C"), label_size = 20)
Fig4
pdf(file = "../figures/Fig4.pdf",
width = 9, height = 9)
Fig4
dev.off()
### SUB df
pdf(file = "../figures/FigSPECIES_77mice.pdf",
width = 9, height = 9)
cowplot::plot_grid(
plotR_SPECIES_77mice + theme(legend.position = "none"),
plotI_SPECIES_77mice + theme(legend.position = "none"),
plotR_SPECIES_77mice,
labels=c("A", "B", "C"), label_size = 20)
dev.off()
pdf(file = "../figures/FigSTRAINS_77mice.pdf",
width = 9, height = 9)
cowplot::plot_grid(
plotR_STRAINS_77mice + theme(legend.position = "none"),
plotI_STRAINS_77mice + theme(legend.position = "none"),
plotR_STRAINS_77mice,
labels=c("A", "B", "C"), label_size = 20)
dev.off()
# full model
modfull <- lm(relWL ~ max.OPG * infection_isolate, data = art2al_SUMdf)
modNOint <- lm(relWL ~ max.OPG + infection_isolate, data = art2al_SUMdf)
modNOisolate <- lm(relWL ~ max.OPG, data = art2al_SUMdf)
# significance of parasite isolate
homemadeGtest(modfull, modNOisolate)
# significance of interaction -> different slopes per parasite isolate?
homemadeGtest(modfull, modNOint)
# test differences between infection groups:
summary(glht(modfull, linfct=mcp(infection_isolate = "Tukey")))
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_WL")
## NB. translate back 0.01 the y axis because we did
# art2al_SUMdf$impact <- art2al_SUMdf$relWL + 0.01
mydaty$predicted_WL <- mydaty$predicted_WL - 0.01
mydaty$conf.low_WL <- mydaty$conf.low_WL - 0.01
mydaty$conf.high_WL <- mydaty$conf.high_WL - 0.01
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
# mydat$x <- as.factor(mydat$x)
# mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="x"] <- "group_col"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
# Trade-off plot
Fig5 <- ggplot(mydat, aes(x = predicted_OPG, y = predicted_WL, col = group)) +
geom_point(aes(pch = x), size = 2) +
geom_errorbar(aes(ymin = conf.low_WL, ymax = conf.high_WL), size = .2)+
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), size = .2)+
geom_smooth(method = "lm", col = "black", alpha = .2, aes(linetype = x), se = F) +
theme_bw()+
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
scale_x_log10(name = "(predicted) maximum oocysts per gram of feces")+
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_WL")
## NB. translate back 0.01 the y axis because we did
# art2al_SUMdf$impact <- art2al_SUMdf$relWL + 0.01
mydaty$predicted_WL <- mydaty$predicted_WL - 0.01
mydaty$conf.low_WL <- mydaty$conf.low_WL - 0.01
mydaty$conf.high_WL <- mydaty$conf.high_WL - 0.01
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
# mydat$x <- as.factor(mydat$x)
# mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="x"] <- "group_col"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_WL")
## NB. translate back 0.01 the y axis because we did
# art2al_SUMdf$impact <- art2al_SUMdf$relWL + 0.01
mydaty$predicted_WL <- mydaty$predicted_WL - 0.01
mydaty$conf.low_WL <- mydaty$conf.low_WL - 0.01
mydaty$conf.high_WL <- mydaty$conf.high_WL - 0.01
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
# mydat$x <- as.factor(mydat$x)
# mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="x"] <- "group"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_WL")
## NB. translate back 0.01 the y axis because we did
# art2al_SUMdf$impact <- art2al_SUMdf$relWL + 0.01
mydaty$predicted_WL <- mydaty$predicted_WL - 0.01
mydaty$conf.low_WL <- mydaty$conf.low_WL - 0.01
mydaty$conf.high_WL <- mydaty$conf.high_WL - 0.01
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
mydat
modfull
plot_model(modfull, type = "int") #+
# mydat$x <- as.factor(mydat$x)
# mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="x"] <- "group_col"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
plot_model(modfull, type = "int") #+
modfull$effects
modfull$terms
mydat
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
mydatx
names(mydatx)[2:5] <- paste0(names(mydatx)[2:5], "_OPG")
mydaty <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "IMP", "STRAINS")$modfull,
terms = c("infection_isolate", "Mouse_genotype"), ci.lvl = 0.95)
names(mydaty)[2:5] <- paste0(names(mydaty)[2:5], "_WL")
## NB. translate back 0.01 the y axis because we did
# art2al_SUMdf$impact <- art2al_SUMdf$relWL + 0.01
mydaty$predicted_WL <- mydaty$predicted_WL - 0.01
mydaty$conf.low_WL <- mydaty$conf.low_WL - 0.01
mydaty$conf.high_WL <- mydaty$conf.high_WL - 0.01
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
mydat$x <- as.factor(mydat$x)
mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="x"] <- "group_col"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull$terms, type = "int") #+
plot_model(modfull$terms, type = "int") #+
plot_model(modfull, type = "int") #+
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
mydat
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
mydat$x <- as.factor(mydat$x)
mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="x"] <- "infection_isolate"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) #+
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
mydat$x <- as.factor(mydat$x)
mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) #+
# names(mydat)[names(mydat) =="x"] <- "infection_isolate"
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) #+
names(mydat)[names(mydat) =="x"] <- "group"
mydat <- merge(data.frame(mydatx), data.frame(mydaty))
mydat$x <- as.factor(mydat$x)
mydat$x <- plyr::mapvalues(mydat$x, from = c("1", "2", "3"), to = levels(art2al_SUMdf$infection_isolate))
names(mydat)[names(mydat) =="group"] <- "Mouse_genotype"
names(mydat)[names(mydat) =="x"] <- "group"
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) #+
plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%"))
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
Fig5
pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
dev.off()
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces") +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.3),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
# take the predictions from before
mydatx <- ggeffects::ggpredict(
model = testSignif(art2al_SUMdf, "RES", "SPECIES")$modfull,
terms = c("Eimeria_species", "Mouse_subspecies"), ci.lvl = 0.95)
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.3),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.2),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
forMap
forMap$color
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.2),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
scale_color_manual(values = forMap$color[1:3]) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
forMap$color[1:3]
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.2),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
scale_color_manual(values = as.character(forMap$color[1:3])) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
forMap$color[1:3]
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.2),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
scale_color_manual(values = c("darkgreen", "green", "orange")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
dev.off()
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.2),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
scale_color_manual(values = c("darkgreen", "green", "orange")) +
scale_fill_manual(values = c("darkgreen", "green", "orange")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
# pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
dev.off()
# Trade-off plot
Fig5 <- plot_model(modfull, type = "int") +
geom_point(data = mydat, aes(x = predicted_OPG, y = predicted_WL, pch = Mouse_genotype), size = 5) +
scale_x_continuous(name = "(predicted) maximum oocysts per gram of feces", limits = c(0, 3e+06)) +
scale_y_continuous(name = "(predicted) maximum weight loss \ncompared to day of infection",
breaks = seq(0,0.3, 0.05), limits = c(0,0.2),
labels = c("0%", "5%", "10%", "15%", "20%", "25%", "30%")) +
scale_color_manual(values = c("darkgreen", "green", "orange")) +
scale_fill_manual(values = c("darkgreen", "green", "orange")) +
ggtitle("Maximum weight loss = f(maximum parasite load) \n(mean and 95%CI)")
Fig5
pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
dev.off()
dev.off()
dev.off()
pdf("../figures/Fig5.pdf", width = 8, height = 5)
Fig5
dev.off()
