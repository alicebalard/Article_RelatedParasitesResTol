rawDF108mice <- DF_all[grep("F0", DF_all$Mouse_genotype),]
length(unique(rawDF108mice$EH_ID))
levels(rawDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
# summary data
summaryDF108mice <- ALL_summary_F0
summaryDF108mice$Mouse_genotype <- droplevels(factor(summaryDF108mice$Mouse_genotype))
summaryDF108mice$Mouse_subspecies <- droplevels(factor(summaryDF108mice$Mouse_subspecies))
levels(summaryDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
summaryDF108mice$Eimeria_species <- as.factor(summaryDF108mice$Eimeria_species)
summaryDF108mice$Eimeria_species <- relevel(summaryDF108mice$Eimeria_species, "E.ferrisi")
length(na.omit(summaryDF108mice$relWL))# 108 F0 mice
length(na.omit(summaryDF108mice$peak.oocysts.per.g.mouse))# 99 F0 mice
length(na.omit(summaryDF108mice$invtolerance))# 99 F0 mice
## Set infection group (group 1 had anthelminthics, did not kill worms, stopped after: test effect)
summaryDF108mice$batch <- summaryDF108mice$Exp_ID
levels(summaryDF108mice$batch) <- c("B1", "B2", "B3", "B4", "B5", "B6")
summaryDF108mice$anth<- FALSE
summaryDF108mice$anth[summaryDF108mice$batch %in% "B1"] <- TRUE
table(summaryDF108mice$infection_isolate, summaryDF108mice$Mouse_genotype, summaryDF108mice$anth)
## Age of mice
range(as.numeric(rawDF108mice$ageAtInfection))
###### what is the overall peak day for each parasite isolate? ######
aggregate(summaryDF108mice$dpi_max.oocysts.per.tube,
list(summaryDF108mice$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
aggregate(summaryDF108mice$dpi_minWeight,
list(summaryDF108mice$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
###### what is the overall prepatent period for each parasite isolate? ######
d <- as.data.frame(
rawDF108mice[!is.na(rawDF108mice$oocysts.per.tube) & rawDF108mice$oocysts.per.tube > 0,] %>%
dplyr::group_by(EH_ID) %>%
dplyr::slice(which.min(dpi)) %>%
dplyr::select(EH_ID, weight, HI, startingWeight, ageAtInfection, Sex,
Mouse_genotype, Eimeria_species, Mouse_subspecies,
infection_isolate, Exp_ID, dpi))
aggregate(d$dpi,
list(d$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
###### Course of infection FIGURE 2 ######
forplot <- rawDF108mice %>%
group_by(infection_isolate, dpi) %>%
summarise(mean = mean(oocysts.per.tube*10e-6, na.rm = TRUE),
sd = sd(oocysts.per.tube*10e-6, na.rm = TRUE),
n = n()) %>%
mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)
F2.1 <- ggplot(forplot, aes(dpi, mean, group = infection_isolate, col = infection_isolate)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lower.ci, ymax = upper.ci), width = .2)+
ylab("oocysts shed (10e6)") +
scale_x_continuous(breaks = 0:11, name = "days post infection") +
theme(legend.position = c(0.25, 0.8)) +
labs(color = "Eimeria isolate")
forplot2 <- rawDF108mice %>%
group_by(infection_isolate, dpi) %>%
summarise(mean = mean(relativeWeight, na.rm = TRUE),
sd = sd(relativeWeight, na.rm = TRUE),
n = n()) %>%
mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)
F2.2 <- ggplot(forplot2, aes(dpi, mean, group = infection_isolate,
col = infection_isolate)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lower.ci, ymax = upper.ci), width = .2)+
ylab("relative weight compared to day 0 (%)") +
scale_x_continuous(breaks = 0:11, name = "days post infection") +
theme(legend.position = c(0.25, 0.2)) +
labs(color = "Eimeria isolate")
library(cowplot)
Fig2 <- plot_grid(F2.1, F2.2,
labels=c("A", "B"), label_size = 20)
#pdf(file = "../figures/Fig2.pdf", width = 10, height = 5)
Fig2
## Correlation sum of oocysts / peak oocysts
summaryDF108mice$sumoocysts.per.tube
summaryDF108mice$max.oocysts.per.tube
## Correlation sum of oocysts / peak oocysts
summaryDF108mice$sumoocysts.per.tube
summaryDF108mice$max.oocysts.per.tube
## Correlation sum of oocysts / peak oocysts
ggplot(summaryDF108mice, aes(sumoocysts.per.tube, max.oocysts.per.tube)) +
geom_smooth(method = "lm")
## Correlation sum of oocysts / peak oocysts
ggplot(summaryDF108mice, aes(sumoocysts.per.tube, max.oocysts.per.tube)) +
geom_smooth(method = "lm")+ geom_point()
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = c("pearson", "kendall", "spearman"))
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = c("pearson", "kendall", "spearman"))
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = "pearson")
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = "kendall")
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = "spearman")
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = "pearson")
# contamination
rawDF108mice$oocysts.per.tube [rawDF108mice$dpi %in% 0]
# contamination
rawDF108mice$oocysts.per.tube[rawDF108mice$dpi %in% 0]
# contamination
rawDF108mice$EH_ID[rawDF108mice$dpi %in% 0 & rawDF108mice$oocysts.per.tube > 0]
# contamination
na.omit(rawDF108mice$EH_ID[rawDF108mice$dpi %in% 0 & rawDF108mice$oocysts.per.tube > 0])
# contamination
coinfMice <- na.omit(rawDF108mice$EH_ID[rawDF108mice$dpi %in% 0 & rawDF108mice$oocysts.per.tube > 0])
length(coinfMice)
# contamination
coinfMice <- rawDF108mice[rawDF108mice$dpi %in% 0 & rawDF108mice$oocysts.per.tube > 0 &
!is.na(rawDF108mice$oocysts.per.tube), ]
length(coinfMice) # 9 mice
nrow(coinfMice) # 9 mice
coinfMice$Mouse_strain, coinfMice$infection_isolate
table(coinfMice$Mouse_strain, coinfMice$infection_isolate)
coinfMice$EH_ID
summaryDF108mice[summaryDF108mice$EH_ID %in% coinfMice$EH_ID,]
### Code for data analysis of Article 2
### August 2019
### Alice Balard
## INFO
# Mouse AA_0088, HI = 0.2
# Mouse AA_0064, HI = 0.08
# Mouse AA_0139, HI = 0.85
#### Load data and functions within ####
source("dataPreparation.R")
###### Map of our samples FIGURE 1 (with design) ######
hmhzline <- read.csv("../data/HMHZ.csv")
area <- get_stamenmap(bbox = c(9, 49, 17, 53.7), zoom = 7,
maptype = "toner-lite")
map <- ggmap(area) +
geom_path(hmhzline, mapping =  aes(x = lon, y = lat), col = "purple", size = 4) +
geom_label_repel(data = forMap,
aes(longitude, latitude, label = Name),
box.padding = 2, size = 5) +
geom_point(data = forMap, aes(longitude, latitude, col = color), size = 6) +
scale_color_manual(values = as.character(levels(forMap$color))) +
theme_bw() +
theme(legend.position = 'none', axis.ticks=element_blank())
map
pdf(file = "../figures/Fig1.pdf", width = 5, height =5)
map
dev.off()
######################################
########## Read information ##########
######################################
# full data
rawDF108mice <- DF_all[grep("F0", DF_all$Mouse_genotype),]
length(unique(rawDF108mice$EH_ID))
levels(rawDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
# summary data
summaryDF108mice <- ALL_summary_F0
summaryDF108mice$Mouse_genotype <- droplevels(factor(summaryDF108mice$Mouse_genotype))
summaryDF108mice$Mouse_subspecies <- droplevels(factor(summaryDF108mice$Mouse_subspecies))
levels(summaryDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
summaryDF108mice$Eimeria_species <- as.factor(summaryDF108mice$Eimeria_species)
summaryDF108mice$Eimeria_species <- relevel(summaryDF108mice$Eimeria_species, "E.ferrisi")
length(na.omit(summaryDF108mice$relWL))# 108 F0 mice
length(na.omit(summaryDF108mice$peak.oocysts.per.g.mouse))# 99 F0 mice
length(na.omit(summaryDF108mice$invtolerance))# 99 F0 mice
## Set infection group (group 1 had anthelminthics, did not kill worms, stopped after: test effect)
summaryDF108mice$batch <- summaryDF108mice$Exp_ID
levels(summaryDF108mice$batch) <- c("B1", "B2", "B3", "B4", "B5", "B6")
summaryDF108mice$anth<- FALSE
summaryDF108mice$anth[summaryDF108mice$batch %in% "B1"] <- TRUE
table(summaryDF108mice$infection_isolate, summaryDF108mice$Mouse_genotype, summaryDF108mice$anth)
##### GENERAL PARASITOLOGY #####
## Age of mice
range(as.numeric(rawDF108mice$ageAtInfection))
###### what is the overall peak day for each parasite isolate? ######
aggregate(summaryDF108mice$dpi_max.oocysts.per.tube,
list(summaryDF108mice$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
aggregate(summaryDF108mice$dpi_minWeight,
list(summaryDF108mice$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
###### what is the overall prepatent period for each parasite isolate? ######
d <- as.data.frame(
rawDF108mice[!is.na(rawDF108mice$oocysts.per.tube) & rawDF108mice$oocysts.per.tube > 0,] %>%
dplyr::group_by(EH_ID) %>%
dplyr::slice(which.min(dpi)) %>%
dplyr::select(EH_ID, weight, HI, startingWeight, ageAtInfection, Sex,
Mouse_genotype, Eimeria_species, Mouse_subspecies,
infection_isolate, Exp_ID, dpi))
aggregate(d$dpi,
list(d$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
###### Course of infection FIGURE 2 ######
forplot <- rawDF108mice %>%
group_by(infection_isolate, dpi) %>%
summarise(mean = mean(oocysts.per.tube*10e-6, na.rm = TRUE),
sd = sd(oocysts.per.tube*10e-6, na.rm = TRUE),
n = n()) %>%
mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)
F2.1 <- ggplot(forplot, aes(dpi, mean, group = infection_isolate, col = infection_isolate)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lower.ci, ymax = upper.ci), width = .2)+
ylab("oocysts shed (10e6)") +
scale_x_continuous(breaks = 0:11, name = "days post infection") +
theme(legend.position = c(0.25, 0.8)) +
labs(color = "Eimeria isolate")
forplot2 <- rawDF108mice %>%
group_by(infection_isolate, dpi) %>%
summarise(mean = mean(relativeWeight, na.rm = TRUE),
sd = sd(relativeWeight, na.rm = TRUE),
n = n()) %>%
mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)
F2.2 <- ggplot(forplot2, aes(dpi, mean, group = infection_isolate,
col = infection_isolate)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lower.ci, ymax = upper.ci), width = .2)+
ylab("relative weight compared to day 0 (%)") +
scale_x_continuous(breaks = 0:11, name = "days post infection") +
theme(legend.position = c(0.25, 0.2)) +
labs(color = "Eimeria isolate")
library(cowplot)
Fig2 <- plot_grid(F2.1, F2.2,
labels=c("A", "B"), label_size = 20)
#pdf(file = "../figures/Fig2.pdf", width = 10, height = 5)
Fig2
#dev.off()
## Correlation sum of oocysts / peak oocysts
ggplot(summaryDF108mice, aes(sumoocysts.per.tube, max.oocysts.per.tube)) +
geom_smooth(method = "lm")+ geom_point()
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = "pearson")
#################################################
########## Chose correct distributions ##########
#################################################
xRes <- as.numeric(na.omit(summaryDF108mice$peak.oocysts.per.g.mouse))
xImp <- as.numeric(na.omit(summaryDF108mice$relWL))
xTol <- as.numeric(na.omit(summaryDF108mice$invtolerance))
hist(xRes, breaks = 100)
descdist(xRes)
# pdf("../figures/supfig1.1.pdf")
findGoodDist(x = xRes, distribs = c("normal", "negative binomial"),
distribs2 = c("norm", "nbinom"))
# dev.off()
### nbinom for resistance
hist(xImp, breaks = 100)
descdist(xImp)
pdf("../figures/supfig1.2.pdf")
findGoodDist(x = xImp+ 0.01, distribs = c("normal", "weibull"),
distribs2 = c("norm", "weibull"))
dev.off()
### weibull for impact on health
summaryDF108mice$impact <- summaryDF108mice$relWL +0.01
# for tolerance, we need to find a way to deal with the massive extreme values
hist(xTol, breaks = 1000)
descdist(xTol)
## too skewed, so we log transform it
translation <- 1e-8
xTol2 <- log10(xTol+translation)
range(xTol2)
hist(xTol2, breaks = 1000)
descdist(xTol2)
pdf("../figures/supfig1.3.pdf")
findGoodDist(x = xTol2, distribs = c("normal"),
distribs2 = c("norm"))
dev.off()
### We translate, log transfor the data to deal with skewness
summaryDF108mice$tolerance <- log10(summaryDF108mice$invtolerance+translation) + 8
summaryDF108mice[is.na(summaryDF108mice$tolerance), c("EH_ID", "Mouse_genotype", "relWL", "peak.oocysts.per.g.mouse")]
# 9 mice died before peak
################
## Resistance ##
################
# Mmd vs Mmm
modResSubsp <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies, data = summaryDF108mice)
anova(modResSubsp)
# SIGNIF infection isolate (p-value = 0.02236) + interactions with mice (p-value = 6.52e-07)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5)
# by strains
modResStrain <- glm.nb(peak.oocysts.per.g.mouse ~ infection_isolate*Mouse_genotype,
data = summaryDF108mice)
anova(modResStrain, test = "LRT")
# SIGNIF infection isolate (p-value = 0.01902) + interactions with mice (p-value = 8.432e-05)
plot_model(modResStrain, type = "int", dot.size = 4, dodge = .5)
## TEST WITHOUT COINF BATCHES
bonusmod <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies,
data = summaryDF108mice[!summaryDF108mice$batch %in% c("B5", "B6"),])
anova(bonusmod)
################
## Resistance ##
################
# Mmd vs Mmm
modResSubsp <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies, data = summaryDF108mice)
anova(modResSubsp)
# SIGNIF infection isolate (p-value = 0.02236) + interactions with mice (p-value = 6.52e-07)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5)
## TEST WITHOUT COINF BATCHES
bonusmod <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies,
data = summaryDF108mice[!summaryDF108mice$batch %in% c("B5", "B6"),])
anova(bonusmod)
plot_model(bonusmod, type = "int", dot.size = 4, dodge = .5)
# SIGNIF infection isolate (p-value = 0.02236) + interactions with mice (p-value = 6.52e-07)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5)
### Code for data analysis of Article 2
### August 2019
### Alice Balard
## INFO
# Mouse AA_0088, HI = 0.2
# Mouse AA_0064, HI = 0.08
# Mouse AA_0139, HI = 0.85
#### Load data and functions within ####
source("dataPreparation.R")
###### Map of our samples FIGURE 1 (with design) ######
hmhzline <- read.csv("../data/HMHZ.csv")
area <- get_stamenmap(bbox = c(9, 49, 17, 53.7), zoom = 7,
maptype = "toner-lite")
map <- ggmap(area) +
geom_path(hmhzline, mapping =  aes(x = lon, y = lat), col = "purple", size = 4) +
geom_label_repel(data = forMap,
aes(longitude, latitude, label = Name),
box.padding = 2, size = 5) +
geom_point(data = forMap, aes(longitude, latitude, col = color), size = 6) +
scale_color_manual(values = as.character(levels(forMap$color))) +
theme_bw() +
theme(legend.position = 'none', axis.ticks=element_blank())
map
pdf(file = "../figures/Fig1.pdf", width = 5, height =5)
map
dev.off()
######################################
########## Read information ##########
######################################
# full data
rawDF108mice <- DF_all[grep("F0", DF_all$Mouse_genotype),]
length(unique(rawDF108mice$EH_ID))
levels(rawDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
# summary data
summaryDF108mice <- ALL_summary_F0
summaryDF108mice$Mouse_genotype <- droplevels(factor(summaryDF108mice$Mouse_genotype))
summaryDF108mice$Mouse_subspecies <- droplevels(factor(summaryDF108mice$Mouse_subspecies))
levels(summaryDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
summaryDF108mice$Eimeria_species <- as.factor(summaryDF108mice$Eimeria_species)
summaryDF108mice$Eimeria_species <- relevel(summaryDF108mice$Eimeria_species, "E.ferrisi")
length(na.omit(summaryDF108mice$relWL))# 108 F0 mice
length(na.omit(summaryDF108mice$peak.oocysts.per.g.mouse))# 99 F0 mice
length(na.omit(summaryDF108mice$invtolerance))# 99 F0 mice
## Set infection group (group 1 had anthelminthics, did not kill worms, stopped after: test effect)
summaryDF108mice$batch <- summaryDF108mice$Exp_ID
levels(summaryDF108mice$batch) <- c("B1", "B2", "B3", "B4", "B5", "B6")
summaryDF108mice$anth<- FALSE
summaryDF108mice$anth[summaryDF108mice$batch %in% "B1"] <- TRUE
table(summaryDF108mice$infection_isolate, summaryDF108mice$Mouse_genotype, summaryDF108mice$anth)
##### GENERAL PARASITOLOGY #####
## Age of mice
range(as.numeric(rawDF108mice$ageAtInfection))
###### what is the overall peak day for each parasite isolate? ######
aggregate(summaryDF108mice$dpi_max.oocysts.per.tube,
list(summaryDF108mice$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
aggregate(summaryDF108mice$dpi_minWeight,
list(summaryDF108mice$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
###### what is the overall prepatent period for each parasite isolate? ######
d <- as.data.frame(
rawDF108mice[!is.na(rawDF108mice$oocysts.per.tube) & rawDF108mice$oocysts.per.tube > 0,] %>%
dplyr::group_by(EH_ID) %>%
dplyr::slice(which.min(dpi)) %>%
dplyr::select(EH_ID, weight, HI, startingWeight, ageAtInfection, Sex,
Mouse_genotype, Eimeria_species, Mouse_subspecies,
infection_isolate, Exp_ID, dpi))
aggregate(d$dpi,
list(d$infection_isolate),
function(x) {paste(length(x), median(x), round(sd(x),2))})
###### Course of infection FIGURE 2 ######
forplot <- rawDF108mice %>%
group_by(infection_isolate, dpi) %>%
summarise(mean = mean(oocysts.per.tube*10e-6, na.rm = TRUE),
sd = sd(oocysts.per.tube*10e-6, na.rm = TRUE),
n = n()) %>%
mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)
F2.1 <- ggplot(forplot, aes(dpi, mean, group = infection_isolate, col = infection_isolate)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lower.ci, ymax = upper.ci), width = .2)+
ylab("oocysts shed (10e6)") +
scale_x_continuous(breaks = 0:11, name = "days post infection") +
theme(legend.position = c(0.25, 0.8)) +
labs(color = "Eimeria isolate")
forplot2 <- rawDF108mice %>%
group_by(infection_isolate, dpi) %>%
summarise(mean = mean(relativeWeight, na.rm = TRUE),
sd = sd(relativeWeight, na.rm = TRUE),
n = n()) %>%
mutate(se = sd / sqrt(n),
lower.ci = mean - qt(1 - (0.05 / 2), n - 1) * se,
upper.ci = mean + qt(1 - (0.05 / 2), n - 1) * se)
F2.2 <- ggplot(forplot2, aes(dpi, mean, group = infection_isolate,
col = infection_isolate)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lower.ci, ymax = upper.ci), width = .2)+
ylab("relative weight compared to day 0 (%)") +
scale_x_continuous(breaks = 0:11, name = "days post infection") +
theme(legend.position = c(0.25, 0.2)) +
labs(color = "Eimeria isolate")
library(cowplot)
Fig2 <- plot_grid(F2.1, F2.2,
labels=c("A", "B"), label_size = 20)
#pdf(file = "../figures/Fig2.pdf", width = 10, height = 5)
Fig2
#dev.off()
## Correlation sum of oocysts / peak oocysts
ggplot(summaryDF108mice, aes(sumoocysts.per.tube, max.oocysts.per.tube)) +
geom_smooth(method = "lm")+ geom_point()
cor(summaryDF108mice$sumoocysts.per.tube , summaryDF108mice$max.oocysts.per.tube,
method = "pearson")
#################################################
########## Chose correct distributions ##########
#################################################
xRes <- as.numeric(na.omit(summaryDF108mice$peak.oocysts.per.g.mouse))
xImp <- as.numeric(na.omit(summaryDF108mice$relWL))
xTol <- as.numeric(na.omit(summaryDF108mice$invtolerance))
hist(xRes, breaks = 100)
descdist(xRes)
# pdf("../figures/supfig1.1.pdf")
findGoodDist(x = xRes, distribs = c("normal", "negative binomial"),
distribs2 = c("norm", "nbinom"))
# dev.off()
### nbinom for resistance
hist(xImp, breaks = 100)
descdist(xImp)
pdf("../figures/supfig1.2.pdf")
findGoodDist(x = xImp+ 0.01, distribs = c("normal", "weibull"),
distribs2 = c("norm", "weibull"))
dev.off()
### weibull for impact on health
summaryDF108mice$impact <- summaryDF108mice$relWL +0.01
# for tolerance, we need to find a way to deal with the massive extreme values
hist(xTol, breaks = 1000)
descdist(xTol)
## too skewed, so we log transform it
translation <- 1e-8
xTol2 <- log10(xTol+translation)
range(xTol2)
hist(xTol2, breaks = 1000)
descdist(xTol2)
pdf("../figures/supfig1.3.pdf")
findGoodDist(x = xTol2, distribs = c("normal"),
distribs2 = c("norm"))
dev.off()
### We translate, log transfor the data to deal with skewness
summaryDF108mice$tolerance <- log10(summaryDF108mice$invtolerance+translation) + 8
summaryDF108mice[is.na(summaryDF108mice$tolerance), c("EH_ID", "Mouse_genotype", "relWL", "peak.oocysts.per.g.mouse")]
# 9 mice died before peak
################
## Resistance ##
################
# Mmd vs Mmm
modResSubsp <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies, data = summaryDF108mice)
anova(modResSubsp)
# SIGNIF infection isolate (p-value = 0.02236) + interactions with mice (p-value = 6.52e-07)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5)
## TEST WITHOUT COINF BATCHES
bonusmod <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies,
data = summaryDF108mice[!summaryDF108mice$batch %in% c("B5", "B6"),])
anova(bonusmod)
plot_model(bonusmod, type = "int", dot.size = 4, dodge = .5)
plot_model(bonusmod, type = "int", dot.size = 4, dodge = .5) + scale_y_log10()
bonusmod <- survreg(Surv(impact)~Eimeria_species*Mouse_subspecies,
data = data = summaryDF108mice[!summaryDF108mice$batch %in% c("B5", "B6"),],
dist="weibull")
bonusmod <- survreg(Surv(impact)~Eimeria_species*Mouse_subspecies,
data = summaryDF108mice[!summaryDF108mice$batch %in% c("B5", "B6"),],
dist="weibull")
anova(bonusmod) # Eimeria species AND mouse subspecies significant
plot_model(bonusmod, type = "int",dot.size = 4, dodge = .5)
## TEST WITHOUT COINF BATCHES --> same direction
bonusmod <-  lm(tolerance ~ Eimeria_species*Mouse_subspecies,
data = summaryDF108mice[!summaryDF108mice$batch %in% c("B5", "B6"),])#                     dist="weibull")
anova(bonusmod)
plot_model(bonusmod, type = "int",dot.size = 4, dodge = .5)
## FINAL test impact of anthelminthics on our 3 variables
summaryDF108mice$anth
mresanth <- glm.nb(peak.oocysts.per.g.mouse ~ anth * infection_isolate*Mouse_genotype, data = summaryDF108mice)
anova(mresanth, test = "LRT")
mimpanth <- survreg(Surv(impact)~anth *infection_isolate*Mouse_genotype, data = summaryDF108mice, dist="weibull")
anova(mimpanth)
mtolanth <- lm(tolerance ~ anth*infection_isolate*Mouse_genotype, data = summaryDF108mice)
anova(mtolanth)
table(summaryDF108mice$anth)
mtolanth <- lm(tolerance ~ anth + infection_isolate*Mouse_genotype, data = summaryDF108mice)
anova(mtolanth)
mresanth <- glm.nb(peak.oocysts.per.g.mouse ~ anth + infection_isolate*Mouse_genotype, data = summaryDF108mice)
anova(mresanth, test = "LRT")
mimpanth <- survreg(Surv(impact)~anth +infection_isolate*Mouse_genotype, data = summaryDF108mice, dist="weibull")
anova(mimpanth)
mtolanth <- lm(tolerance ~ anth + infection_isolate*Mouse_genotype, data = summaryDF108mice)
anova(mtolanth)
table(summaryDF108mice$batch)
