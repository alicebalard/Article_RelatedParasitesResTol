table(rawDF108mice$EH_ID, rawDF108mice$Exp_ID)
table(rawDF108mice$EH_ID, rawDF108mice$Exp_ID)
## ELISA on feces, detection Eimeria
## Protocol from Ivet Yordanova
# weight the feces for later having concentration
# resuspend in PBS (1mL/g feces)
# spin max speed 3-5 min
# test different speed and timing
# homogenize +++
# clear liquid
# clear supernatant, either freeze or process right away
# Make standard curve by pooling material:
# all samples day 0 (control) / all samples peak day E.fal / all samples peak day E.fer
# then you find the correct dilutiuon
# possibly if no detection, sequential ELISA
# Ivet has done IgG-IgA in routine, with home made products, she send me the protocol + INFgamma
############################
########## Code ############
############################
source("Article2_analysis.R")
## Samples available for ELISA: feces collected and frozen
#################################
## Set : 26 mice, pl√∂n pre inf ##
#################################
#Extra (unavailable) For Norus 29/05/2018 pre TRT with worms ~25 mice (Lost info...must be Expe003 dpi0 or expe004 dpi <0)
set1 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/1_informationTables/E2_052017_Eim_crossing_infection_INFO.csv")
########################################################
## Set 2: 38 mice, dpi 0 and 6, E. ferrisi 2 isolates ##
########################################################
# For Norus dpi 0 + dpi6 133etc.
## Expe003:
data1 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/2_designTables/E3_042018_Eim_wildmice_Eferrisi_Firstbatch_DESIGN.csv")
# Expe003labels <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/3_recordingTables/E4_042018_Eim_wildmice_Eferrisi_Firstbatch_RECORDoocysts.csv")
labelmatching <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/3_recordingTables/E4_042018_Eim_wildmice_Eferrisi_Firstbatch_RECORDweight.csv")
# We have the feces of mice Expe003 at dpi 0:
Expe003_dpi0 <- data.frame(EH_ID = paste0("LM0", c(124:127, 129, 131,133:137, 139:142,144)),
dpi = 0)
# We have the feces of mice Expe003 at dpi 6:
Expe003_dpi6 <- labelmatching[labelmatching$dpi == 6, c("Exp_ID", "labels",  "EH_ID", "dpi")]
## Define first set of ELISA
set2 <- merge(Expe003_dpi0, Expe003_dpi6, all = T)
set2$boxname <- "for Norus"
# add full info
set2 <- merge(set2, data1)
##########################################################
## Set 3: 33 mice, dpi 0 to 11 6, E. ferrisi 2 isolates ##
##########################################################
# June 2018 dpi 1, 2, 3 full box AJX
# June 2018 dpi 3,4,5 (6) full box AQZ
# June 2018 eXPE 004 dpi 6,7,8 full box AQZ eXPLE ade
# June 2018 Expe004 dpi 8,9,10,11 full box. Exple KRT
# jUNE 2018 eXPE 004 dpi11 x17 exple CFJ
## Expe004:
set3 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/3_recordingTables/E5_062018_Eim_wildmice_Eferrisi_Secondbatch_RECORDweight.csv")
infoset3 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/2_designTables/E4_062018_Eim_wildmice_Eferrisi_Secondbatch_DESIGN.csv")
length(unique(set3$EH_ID)) # 33 mice
length(unique(infoset3$EH_ID)) # 33 mice
set3 <- merge(set3, infoset3, by = "EH_ID")
table(set3$infection_isolate, set3$dpi) # 17 E64, 16 E139
table(set3$infection_isolate, set3$Strain, set3$dpi)
length(unique(rawDF108mice$EH_ID))
table(rawDF108mice$EH_ID, rawDF108mice$Exp_ID)
##### mice from expe 5-1a&b, all data from dpi 0 to 10-11
rawDF
##### mice from expe 5-1a&b, all data from dpi 0 to 10-11
rawDF108mice$Exp_ID
##### mice from expe 5-1a&b, all data from dpi 0 to 10-11
table(rawDF108mice$Exp_ID)
##### mice from expe 5-1a&b, all data from dpi 0 to 10-11
table(rawDF108mice$Exp_ID, rawDF108mice$dpi)
grep("Exp_005_1", rawDF108mice$Exp_ID)
rawDF108mice[grep("Exp_005_1", rawDF108mice$Exp_ID)]
rawDF108mice[grep("Exp_005_1", rawDF108mice$Exp_ID),]
table(summaryDF108mice$Exp_ID)
summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
ElisaDF <- summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
ElisaDF$Mouse_genotype
table(ElisaDF$Mouse_genotype, ElisaDF$infection_isolate
table(ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
table(ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point()
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(aes(col = group))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(aes(col = infection_isolate))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(aes(col = infection_isolate, shape = Mouse_genotype))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 5, aes(col = infection_isolate, shape = Mouse_genotype))
geom_point(size = 5, aes(col =Mouse_genotype, shape = infection_isolate)) +
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 5, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 5, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 10,, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 10, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 10, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1")) +
scale_shape_manual(value = c(16, 21))
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 10, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1")) +
scale_shape_manual(values = c(16, 21))
View(ElisaDF)
ElisaDF$ToleranceIndex
data.frame(ElisaDF$ToleranceIndex, ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
data.frame(ElisaDF$ToleranceIndex, ElisaDF$relWL, ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
data.frame(ElisaDF$ToleranceIndex, ElisaDF$relWL*100, ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
data.frame(ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
data.frame(ElisaDF$ResistanceIndex, ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
data.frame(ElisaDF$peak.oocysts.per.g.mouse, ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
View(ElisaDF)
data.frame(ElisaDF$peak.oocysts.per.g.mouse, ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
data.frame(ElisaDF$EH_ID, ElisaDF$peak.oocysts.per.g.mouse, ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
# missing data for:
c("LM0202","LM0193", "LM0187")
# missing data for:
rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187")
# missing data for:
rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID)) +
geom_point() + geom_line() + geom_label(aes(label= EH_ID))
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate))# +
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() #+
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() #+
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel()
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = weight, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = relWeight, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = relWL, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = relativeWeight, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[!rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
dev.off()
ggplot(rawDF108mice[!rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[!rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line()
fullElisaDF <- rawDF108mice[!rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label(fullElisaDF[fullElisaDF$dpi = 10,])
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label(fullElisaDF[fullElisaDF$dpi = 10,], aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label(fullElisaDF[fullElisaDF$dpi = 10,], aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi = 10,], aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi %in% 10,], aes(label= EH_ID))
ElisaDF$EH_ID
# ElisaDF <-
summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
# ElisaDF <-
summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID) & !summaryDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
# ElisaDF <-
summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID) & !summaryDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
# ElisaDF <-
summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
ElisaDF$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
ElisaDF[!ElisaDF$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
ElisaDF <- ElisaDF[!ElisaDF$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
table(ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
############### FINAL ELISA DF ###############
ElisaDF <- summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
table(ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 10, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1")) +
scale_shape_manual(values = c(16, 21))
data.frame(ElisaDF$EH_ID, ElisaDF$peak.oocysts.per.g.mouse, ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = relativeWeight, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
fullElisaDF <- rawDF108mice[!rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),]
fullElisaDF <- rawDF108mice[rawDF108mice$EH_ID %in% ElisaDF$EH_ID,]
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi %in% 10,], aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 10,], aes(label= EH_ID))
#"LM0202" had liquid feces uncollectable at dpi8
# "LM0193", "LM0187" died at dpi7-8
library(ggrepel)
fullElisaDF <- rawDF108mice[rawDF108mice$EH_ID %in% ElisaDF$EH_ID,]
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 10,], aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(aes(label= EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel()
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi %in% 6,])
geom_label_repel
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 6,])
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 6,], fill = EH_ID)
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 6,], aes(fill = EH_ID))
## ELISA on feces, detection Eimeria
## Protocol from Ivet Yordanova
# weight the feces for later having concentration
# resuspend in PBS (1mL/g feces)
# spin max speed 3-5 min
# test different speed and timing
# homogenize +++
# clear liquid
# clear supernatant, either freeze or process right away
# Make standard curve by pooling material:
# all samples day 0 (control) / all samples peak day E.fal / all samples peak day E.fer
# then you find the correct dilutiuon
# possibly if no detection, sequential ELISA
# Ivet has done IgG-IgA in routine, with home made products, she send me the protocol + INFgamma
############################
########## Code ############
############################
source("Article2_analysis.R")
## Samples available for ELISA: feces collected and frozen
#################################
## Set : 26 mice, pl√∂n pre inf ##
#################################
#Extra (unavailable) For Norus 29/05/2018 pre TRT with worms ~25 mice (Lost info...must be Expe003 dpi0 or expe004 dpi <0)
set1 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/1_informationTables/E2_052017_Eim_crossing_infection_INFO.csv")
########################################################
## Set 2: 38 mice, dpi 0 and 6, E. ferrisi 2 isolates ##
########################################################
# For Norus dpi 0 + dpi6 133etc.
## Expe003:
data1 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/2_designTables/E3_042018_Eim_wildmice_Eferrisi_Firstbatch_DESIGN.csv")
# Expe003labels <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/3_recordingTables/E4_042018_Eim_wildmice_Eferrisi_Firstbatch_RECORDoocysts.csv")
labelmatching <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/3_recordingTables/E4_042018_Eim_wildmice_Eferrisi_Firstbatch_RECORDweight.csv")
# We have the feces of mice Expe003 at dpi 0:
Expe003_dpi0 <- data.frame(EH_ID = paste0("LM0", c(124:127, 129, 131,133:137, 139:142,144)),
dpi = 0)
# We have the feces of mice Expe003 at dpi 6:
Expe003_dpi6 <- labelmatching[labelmatching$dpi == 6, c("Exp_ID", "labels",  "EH_ID", "dpi")]
## Define first set of ELISA
set2 <- merge(Expe003_dpi0, Expe003_dpi6, all = T)
set2$boxname <- "for Norus"
# add full info
set2 <- merge(set2, data1)
##########################################################
## Set 3: 33 mice, dpi 0 to 11 6, E. ferrisi 2 isolates ##
##########################################################
# June 2018 dpi 1, 2, 3 full box AJX
# June 2018 dpi 3,4,5 (6) full box AQZ
# June 2018 eXPE 004 dpi 6,7,8 full box AQZ eXPLE ade
# June 2018 Expe004 dpi 8,9,10,11 full box. Exple KRT
# jUNE 2018 eXPE 004 dpi11 x17 exple CFJ
## Expe004:
set3 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/3_recordingTables/E5_062018_Eim_wildmice_Eferrisi_Secondbatch_RECORDweight.csv")
infoset3 <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/2_designTables/E4_062018_Eim_wildmice_Eferrisi_Secondbatch_DESIGN.csv")
length(unique(set3$EH_ID)) # 33 mice
length(unique(infoset3$EH_ID)) # 33 mice
set3 <- merge(set3, infoset3, by = "EH_ID")
table(set3$infection_isolate, set3$dpi) # 17 E64, 16 E139
table(set3$infection_isolate, set3$Strain, set3$dpi)
length(unique(rawDF108mice$EH_ID))
table(rawDF108mice$EH_ID, rawDF108mice$Exp_ID)
##### mice from expe 5-1a&b, all data from dpi 0 to 10-11
table(rawDF108mice$Exp_ID, rawDF108mice$dpi)
table(summaryDF108mice$Exp_ID)
############### FINAL ELISA DF ###############
ElisaDF <- summaryDF108mice[grep("Exp_005_1", summaryDF108mice$Exp_ID),]
table(ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
ggplot(ElisaDF, aes(x = ResistanceIndex, y = ToleranceIndex))+
geom_point(size = 10, aes(col =Mouse_genotype, shape = infection_isolate)) +
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1")) +
scale_shape_manual(values = c(16, 21))
data.frame(ElisaDF$EH_ID, ElisaDF$peak.oocysts.per.g.mouse, ElisaDF$ToleranceIndex, round(ElisaDF$relWL*100), ElisaDF$Mouse_genotype, ElisaDF$infection_isolate)
# missing data for:
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
ggplot(rawDF108mice[rawDF108mice$EH_ID %in% c("LM0202","LM0193", "LM0187"),],
aes(x = dpi, y = relativeWeight, group = EH_ID, col = infection_isolate, label= EH_ID)) +
geom_point() +
geom_line() +
geom_label()
#"LM0202" had liquid feces uncollectable at dpi8
# "LM0193", "LM0187" died at dpi7-8
library(ggrepel)
fullElisaDF <- rawDF108mice[rawDF108mice$EH_ID %in% ElisaDF$EH_ID,]
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 6,], aes(fill = EH_ID))
# data = fullElisaDF[fullElisaDF$dpi %in% 10,],
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi %in% 6,], aes(fill = EH_ID))
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi %in% 6,], aes(fill = EH_ID)) +
theme(legend.position = NA)
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label(data = fullElisaDF[fullElisaDF$dpi %in% 6,], aes(fill = EH_ID)) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 6,], aes(fill = EH_ID)) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 6,]) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% 7,]) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% c(6,8),]) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% c(6,8),], force = 2) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
geom_label_repel(data = fullElisaDF[fullElisaDF$dpi %in% c(6,8),], force = 2) +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
theme(legend.position = "none")
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line()
View(fullElisaDF)
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.g.mouse, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
scale_y_log10()
ggplot(fullElisaDF,
aes(x = dpi, y = oocysts.per.tube, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
scale_y_log10()
ggplot(fullElisaDF,
aes(x = dpi, y = OPG, group = EH_ID, col = infection_isolate, label =  EH_ID)) +
geom_point() +
geom_line() +
scale_y_log10()
