########## Define our indexes and their distribution ##########
###############################################################
## RESISTANCE
# for models, inverse of parasite density:
summaryDF108mice$peak.oocysts.per.g.mouse
# for plots, invert + translation positive (300000) / 10000:
getResistanceIndex <- function(x){
y = (- x + 300000)/300000
return(y)}
summaryDF108mice$ResistanceIndex <- getResistanceIndex(summaryDF108mice$peak.oocysts.per.g.mouse)
plotChoiceResIndex <- ggplot(summaryDF108mice, aes(peak.oocysts.per.g.mouse, ResistanceIndex)) +
geom_point(size = 4, pch =21) +
ylab("Resistance Index") +
xlab("Parasite density (oocysts per mouse gram) at peak day")
plotChoiceResIndex
xRes <- as.numeric(na.omit(summaryDF108mice$peak.oocysts.per.g.mouse))
hist(xRes, breaks = 100)
descdist(xRes)
pdf("../figures/supfig1.1.pdf")
findGoodDist(x = xRes, distribs = c("normal", "negative binomial"),
distribs2 = c("norm", "nbinom"))
dev.off()
### nbinom for resistance
## IMPACT ON HEALTH
xImp <- as.numeric(na.omit(summaryDF108mice$relWL))
hist(xImp, breaks = 100)
descdist(xImp)
pdf("../figures/supfig1.2.pdf")
findGoodDist(x = xImp+ 0.01, distribs = c("normal", "weibull"),
distribs2 = c("norm", "weibull"))
dev.off()
### weibull for impact on health
summaryDF108mice$impact <- summaryDF108mice$relWL +0.01
## TOLERANCE
summaryDF108mice$ToleranceIndex <- log10(
summaryDF108mice$relWL / summaryDF108mice$peak.oocysts.per.g.mouse + 1e-8) / (-8)
plotChoiceTolIndex <- ggplot(summaryDF108mice,
aes(x=peak.oocysts.per.g.mouse, y =relWL, fill = ToleranceIndex))+
geom_point(size = 4, pch =21) +
scale_fill_gradient(low = "white", high = "black") +
xlab("Parasite density (oocysts per mouse gram) at peak day") +
ylab("Maximum relative weight loss compared to day 0 (%)") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
labs(fill = "Tolerance Index") +
theme(
legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6)
)
plotChoiceTolIndex
xTol <- as.numeric(na.omit(summaryDF108mice$ToleranceIndex))
# for tolerance, we need to find a way to deal with the massive extreme values
hist(xTol, breaks = 1000)
descdist(xTol)
pdf("../figures/supfig1.3.pdf")
findGoodDist(x = xTol, distribs = c("normal"),
distribs2 = c("norm"))
dev.off()
summaryDF108mice[is.na(summaryDF108mice$ToleranceIndex), c("EH_ID", "Mouse_genotype", "relWL", "peak.oocysts.per.g.mouse")]
# 9 mice died before peak
#
pdf(file = "../figures/choiceIndexes.pdf", width = 10, height = 5)
plot_grid(plotChoiceResIndex,
plotChoiceTolIndex,
labels=c("A", "B"), label_size = 15)
dev.off()
################################
##### Statistical analyses #####
################################
################
## Resistance ##
################
# Mmd vs Mmm
modResSubsp <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies, data = summaryDF108mice)
modResSubsp
anova(modResSubsp)
# SIGNIF infection isolate (p-value = 0.02236) + interactions with mice (p-value = 6.52e-07)
summary(modResSubsp)
# by strains
modResStrain <- glm.nb(peak.oocysts.per.g.mouse ~ infection_isolate*Mouse_genotype,
data = summaryDF108mice)
anova(modResStrain, test = "LRT")
# SIGNIF infection isolate (p-value = 0.01902) + interactions with mice (p-value = 8.432e-05)
## And plot:
## To add Ns on top of bars
getNs <- function(proxy, df, groupMus = "Mouse_genotype", groupPar = "infection_isolate"){
noNA = df[!is.na(df[[proxy]]),]
noNA$groupMus = noNA[[groupMus]]
noNA$groupPar = noNA[[groupPar]]
tab = table(noNA$groupPar, noNA$groupMus)
Ns = as.character(as.vector(t(tab)[as.vector(t(tab))!=0]))
return(Ns)
}
## Fig 3
# plot marginal effects of interaction terms
posx.1 <- c(0.9,1.1, 1.9,2.1)
## FOR PLOT, use Resistance Index
y = seq(0,1,0.05)
x = -y * 300000 + 300000
plotR_F0_subsp <- plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=90000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
plotR_F0_subsp
# plot marginal effects of interaction terms by isolates & strains
posx.2 <- c(0.8+c(0,1/8,2/8,3/8),1.8+c(0,1/8,2/8,3/8),2.8+c(0,1/8,2/8,3/8))
## and plot
plotR_F0_strains <- plot_model(modResStrain, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria isolate") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.2,y=120000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice)),vjust=0)
plotR_F0_strains
############
## Impact ##
############
modImpSubsp <- survreg(Surv(impact)~Eimeria_species*Mouse_subspecies, data = summaryDF108mice, dist="weibull")
anova(modImpSubsp) # Eimeria species AND mouse subspecies significant
## Translation of 1% because Weibull doesn't support nul data
modImpStrain <- survreg(Surv(impact)~infection_isolate*Mouse_genotype, data = summaryDF108mice, dist="weibull")
anova(modImpStrain)
length(summaryDF108mice$relWL)
# Eimeria isolate significant
plotI_F0_subsp <- plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue","red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ggtitle("Impact on host health") +
ylab("(predicted) maximum weight loss") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=0,label=getNs("relWL", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plotI_F0_subsp
plotI_F0_strains <- plot_model(modImpStrain, type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
xlab("Eimeria isolate") +
ggtitle("Impact on host health") +
ylab("(predicted) maximum weight loss") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.2,y=0,label=getNs("relWL", summaryDF108mice)),vjust=0)
plotI_F0_strains
###############
## Tolerance ##
###############
modTolSubspecies <- lm(ToleranceIndex ~ Eimeria_species*Mouse_subspecies, data = summaryDF108mice)
anova(modTolSubspecies)
length(na.omit(summaryDF108mice$ToleranceIndex))
modTolStrain <- lm(ToleranceIndex ~ infection_isolate*Mouse_genotype, data = summaryDF108mice)
anova(modTolStrain)
# mouse genotype & interactions significant
plotT_F0_subsp <- plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plotT_F0_subsp
plotT_F0_strain <- plot_model(modTolStrain, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1"),
name = "Mouse strain",labels = c("SCHUNT", "STRA", "BUSNA", "PWD")) +
xlab("Eimeria isolate") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.2,y=0.4,label=getNs("ToleranceIndex", summaryDF108mice)),vjust=0)
plotT_F0_strain
# Fig 3.
Fig3 <- plot_grid(plotR_F0_subsp + theme(legend.position = "none"),
plotI_F0_subsp + theme(legend.position = "none"),
plotT_F0_subsp+ theme(legend.position = "none"),
plotT_F0_subsp ,
labels=c("A", "B", "C", "D"), label_size = 20)
Fig3
pdf(file = "../figures/Fig3.pdf",
width = 9, height = 9)
Fig3
dev.off()
## Fig 4
Fig4 <- plot_grid(plotR_F0_strains + theme(legend.position = "none"),
plotI_F0_strains + theme(legend.position = "none"),
plotT_F0_strain + theme(legend.position = "none"),
plotT_F0_strain,
labels=c("A", "B", "C", "D"), label_size = 20)
Fig4
pdf(file = "../figures/Fig4.pdf",
width = 9, height = 9)
Fig4
dev.off()
stargazer(modResSubsp, modImpSubsp, modTolSubspecies,  type = "text")
stargazer(modResSubsp, modImpSubsp, modTolSubspecies,  type = "html")
stargazer(modResSubsp, modImpSubsp, modTolSubspecies,  type = "html")
stargazer(modResStrain, modImpStrain, modTolStrain,  type = "html")
stargazer(modResSubsp, modImpSubsp, modTolSubspecies,  type = "text")
stargazer(modResSubsp, modImpSubsp, modTolSubspecies)#,  type = "html")
#### Load data and functions within ####
source("dataPreparation.R")
# full data
rawDF108mice <- DF_all[grep("F0", DF_all$Mouse_genotype),]
# calculate weight retained per day
d <- rawDF108mice[rawDF108mice$dpi == 0., c("weight", "EH_ID")]
names(d)[1] <- "weightdpi0"
rawDF108mice <- merge(d, rawDF108mice)
rawDF108mice$weightRelativeToInfection <- rawDF108mice$weight / rawDF108mice$weightdpi0 * 100
# Rename levels
levels(rawDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
# summary data
summaryDF108mice <- ALL_summary_F0
summaryDF108mice$Mouse_genotype <- droplevels(factor(summaryDF108mice$Mouse_genotype))
summaryDF108mice$Mouse_subspecies <- droplevels(factor(summaryDF108mice$Mouse_subspecies))
levels(summaryDF108mice$infection_isolate) <- c("Brandenburg139 (E. ferrisi)",
"Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
summaryDF108mice$Eimeria_species <- as.factor(summaryDF108mice$Eimeria_species)
summaryDF108mice$Eimeria_species <- relevel(summaryDF108mice$Eimeria_species, "E.ferrisi")
## Set infection group (group 1 had anthelminthics, did not kill worms, stopped after: test effect)
summaryDF108mice$batch <- summaryDF108mice$Exp_ID
levels(summaryDF108mice$batch) <- c("B1", "B2", "B3", "B4", "B5", "B6")
summaryDF108mice$anth<- FALSE
summaryDF108mice$anth[summaryDF108mice$batch %in% "B1"] <- TRUE
# REMOVE animals with anth (N = 108 - 86 = 22)
sumDFnoANTH <- summaryDF108mice[summaryDF108mice$anth == FALSE,]
## Coinfection? (N = 86 -77 = 9)
contaAnimals <- rawDF108mice[rawDF108mice$oocysts.per.tube > 0 & !is.na(rawDF108mice$oocysts.per.tube) &
rawDF108mice$dpi == 0, "EH_ID"]
sumDFnoANTHnoCONTA <- sumDFnoANTH[!sumDFnoANTH$EH_ID %in% contaAnimals,]
###############
## Resistance ##
################
# Mmd vs Mmm
modResSubsp <- glm.nb(peak.oocysts.per.g.mouse ~ Eimeria_species*Mouse_subspecies, data = sumDFnoANTHnoCONTA)
anova(modResSubsp)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5)
############
## Impact ##
############
sumDFnoANTHnoCONTA$impact <- sumDFnoANTHnoCONTA$relWL +0.01
modImpSubsp <- survreg(Surv(impact)~Eimeria_species*Mouse_subspecies, data = sumDFnoANTHnoCONTA, dist="weibull")
anova(modImpSubsp) # Eimeria species AND mouse subspecies significant
plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5)
anova(modResSubsp)
nrow(sumDFnoANTHnoCONTA)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=90000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
# plot marginal effects of interaction terms
posx.1 <- c(0.9,1.1, 1.9,2.1)
## FOR PLOT, use Resistance Index
y = seq(0,1,0.05)
x = -y * 300000 + 300000
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=90000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
## And plot:
## To add Ns on top of bars
getNs <- function(proxy, df, groupMus = "Mouse_genotype", groupPar = "infection_isolate"){
noNA = df[!is.na(df[[proxy]]),]
noNA$groupMus = noNA[[groupMus]]
noNA$groupPar = noNA[[groupPar]]
tab = table(noNA$groupPar, noNA$groupMus)
Ns = as.character(as.vector(t(tab)[as.vector(t(tab))!=0]))
return(Ns)
}
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=90000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=80000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=100000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
############
## Impact ##
############
sumDFnoANTHnoCONTA$impact <- sumDFnoANTHnoCONTA$relWL +0.01
modImpSubsp <- survreg(Surv(impact)~Eimeria_species*Mouse_subspecies, data = sumDFnoANTHnoCONTA, dist="weibull")
anova(modImpSubsp) # Eimeria species AND mouse subspecies significant
plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5)
plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue","red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ggtitle("Impact on host health") +
ylab("(predicted) maximum weight loss") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=0,label=getNs("relWL", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=100000,label=getNs("peak.oocysts.per.g.mouse", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
anova(modResSubsp)
nrow(sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse)
length(sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse)
length(!is.na(sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse))
sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse
length(na.omit(sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse))
length(na.omit(sumDFnoANTHnoCONTA$impact))
modImpSubsp <- survreg(Surv(impact)~Eimeria_species*Mouse_subspecies, data = sumDFnoANTHnoCONTA, dist="weibull")
anova(modImpSubsp) # Eimeria species AND mouse subspecies significant
###############
## Tolerance ##
###############
sumDFnoANTHnoCONTA$ToleranceIndex <- log10(
sumDFnoANTHnoCONTA$relWL / sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse + 1e-8) / (-8)
modTolSubspecies <- lm(ToleranceIndex ~ Eimeria_species*Mouse_subspecies, data = sumDFnoANTHnoCONTA)
anova(modTolSubspecies)
length(na.omit(sumDFnoANTHnoCONTA$ToleranceIndex))
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5)
plotT_F0_subsp
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5)
## Fig 3
# plot marginal effects of interaction terms
posx.1 <- c(0.9,1.1, 1.9,2.1)
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", summaryDF108mice,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))#+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", sumDFnoANTHnoCONTA,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", sumDFnoANTHnoCONTA,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue","red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ggtitle("Impact on host health") +
ylab("(predicted) maximum weight loss") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=0,label=getNs("relWL", sumDFnoANTHnoCONTA,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modResSubsp, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
ggtitle("Resistance") +
scale_y_continuous("(predicted) Resistance Index",
trans = "reverse",
breaks = x,
labels = y) +
xlab("Eimeria species") +
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=100000,label=getNs("peak.oocysts.per.g.mouse", sumDFnoANTHnoCONTA,
"Mouse_subspecies", "Eimeria_species")), vjust=0)
plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5)
plot_model(modImpSubsp, type = "int",dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue","red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ggtitle("Impact on host health") +
ylab("(predicted) maximum weight loss") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
theme(axis.title.x = element_text(hjust=1), axis.text=element_text(size=13)) +
geom_text(aes(x=posx.1,y=0,label=getNs("relWL", sumDFnoANTHnoCONTA,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
plot_model(modTolSubspecies, type = "int", dot.size = 4, dodge = .5) + # mean-value and +/- 1 standard deviation
scale_color_manual(values = c("blue", "red"),
name = "Mouse subspecies",labels = c("Mmd", "Mmm")) +
xlab("Eimeria species") +
ylab("(predicted) Tolerance index")+
ggtitle("Tolerance") +
theme(axis.title.x = element_text(hjust=1), axis.text = element_text(size=13))+
geom_text(aes(x=posx.1,y=0.4,label=getNs("ToleranceIndex", sumDFnoANTHnoCONTA,
"Mouse_subspecies", "Eimeria_species")),vjust=0)
### Second part: correlation resistance / tolerance
getResistanceIndex <- function(x){
y = (- x + 300000)/300000
return(y)}
sumDFnoANTHnoCONTA$ResistanceIndex <- getResistanceIndex(sumDFnoANTHnoCONTA$peak.oocysts.per.g.mouse)
# Calculate mean per group
# Packages we need
library(ggplot2)
library(dplyr)
# Create a group-means data set
gd <- sumDFnoANTHnoCONTA %>%
group_by(Mouse_genotype, infection_isolate) %>%
summarise(
ResistanceIndex = mean(ResistanceIndex, na.rm = T),
ToleranceIndex = mean(ToleranceIndex, na.rm = T)
)
gd
# define the 8 groups
sumDFnoANTHnoCONTA$group <- paste(sumDFnoANTHnoCONTA$Mouse_genotype, sumDFnoANTHnoCONTA$infection_isolate, sep = "_")
# Plot both data sets
restolplot <- ggplot(sumDFnoANTHnoCONTA, aes(x = ResistanceIndex, y = ToleranceIndex)) +
geom_smooth(method = "lm", col = "black", alpha = .2, aes(linetype = Eimeria_species)) +
geom_point(alpha = .4, aes(col = Mouse_genotype, fill = Mouse_genotype, shape = infection_isolate), size = 4) +
geom_point(data = gd, aes(fill = Mouse_genotype, shape = infection_isolate), size = 10) +
theme_bw()+
scale_color_manual(values = c("blue", "cornflowerblue", "red4", "indianred1")) +
scale_fill_manual(values = c("blue", "cornflowerblue", "red4", "indianred1")) +
scale_shape_manual(values = c(24,22,21)) +
ylab(label = "Tolerance index") +
scale_x_continuous(name = "Resistance index")
restolplot
# https://stats.idre.ucla.edu/r/seminars/interactions-r/
# Test the difference between slopes:
modResTol <- lm(formula = ToleranceIndex ~ ResistanceIndex * Eimeria_species, data = sumDFnoANTHnoCONTA)
summary(modResTol)
