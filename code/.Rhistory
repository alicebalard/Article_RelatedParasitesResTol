testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 4000000, 1000000),
labels = seq(0, 4000000, 1000000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG") +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
listBigPlot_6488$full
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 4000000, 500000),
labels = seq(0, 4000000, 500000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG") +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
listBigPlot_6488$full
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000)) +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000)) +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000) +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
listBigPlot_6488$full
listBigPlot_6488$full
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG",
breaks = c(100000, 300000, 1000000, 3000000),
labels = c(100000, 300000, 1000000, 3000000)/1000000) +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
listBigPlot_6488$full
listBigPlot_6488$full
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = seq(0, 3000000, 500000),
labels = seq(0, 3000000, 500000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum OPG",
breaks = c(300000, 500000, 1000000, 2000000, 3000000),
labels = c(300000, 500000, 1000000, 2000000, 3000000)/1000000) +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
listBigPlot_6488$full
getBigPlot <- function(x){
predRes <- getPred(x, "RES")
predImp <- getPred(x, "IMP")
predTol <- getPredTol(x)
finalplotDF <- getMergeRIT(predRes, predImp, predTol)
finalplotDF
# test correlations:
listPar <- list("Brandenburg64 (E. ferrisi)", "Brandenburg88 (E. falciformis)")
l1 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_relWL"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext1 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l1))
l2 <- lapply(listPar, function(x){
c <- cor.test(finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_OPG"],
finalplotDF[finalplotDF$infection_isolate %in% x, "predicted_Tol"],
method="spearman")
paste0(as.character(c$method), ": ", round(c$estimate, 2), ",\n p-value=",  signif(c$p.value, digits=2))
})
addCortext2 <- data.frame(infection_isolate = unlist(listPar),
testcor = unlist(l2))
## Plot raw (WL vs OPG) and res-tol
## Plot1
P1 <- ggplot(finalplotDF, aes(x=predicted_OPG, y=predicted_relWL)) +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_errorbar(aes(ymin = conf.low_relWL, ymax = conf.high_relWL), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
facet_grid(.~infection_isolate)+
scale_x_log10(name = "Maximum million oocysts per gram of feces (OPG)",
breaks = c(100000, 300000, 500000, 1000000, 2000000, 3000000),
labels = c(100000, 300000, 500000, 1000000, 2000000, 3000000)/1000000) +
scale_y_continuous(name = "Maximum relative weight loss",
labels = scales::percent_format(accuracy = 5L))+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black")+
geom_text(data = addCortext1, aes(label = testcor, x = 1.8e6, y = 0.17))
P1
## Plot2
P2 <- ggplot(finalplotDF, aes(x = predicted_OPG, y = predicted_Tol)) +
geom_errorbar(aes(ymin = conf.low_Tol, ymax = conf.high_Tol), color = "grey") +
geom_errorbarh(aes(xmin = conf.low_OPG, xmax = conf.high_OPG), color = "grey") +
geom_point(aes(col = Genotype), size = 7)+
scale_x_continuous(trans=reverselog_trans(10), "RESISTANCE \n(inverse of) maximum million OPG",
breaks = c(100000, 300000, 500000, 1000000, 2000000, 3000000),
labels = c(100000, 300000, 500000, 1000000, 2000000, 3000000)/1000000) +
scale_y_continuous(trans=reverselog_trans(10), name = "TOLERANCE \n(inverse of) slope of maximum weight loss on maximum OPG")+
facet_grid(.~infection_isolate)+
geom_text(aes(label=substring(Genotype, 1, 1)), col = "white")+
coord_cartesian(ylim=c(0.5,0.01))+
scale_color_manual(values = mycolors) +
geom_smooth(method = "lm", se = F, col = "black") +
geom_text(data = addCortext2, aes(label = testcor, x = 1.5e6, y = 0.22))
P2
bigPlot <- cowplot::ggdraw() +
draw_plot(P1, 0, .5, 1, .5) +
draw_plot(P2, 0, 0, 1, .5)
bigPlot
}
listBigPlot_6488 <- lapply(MyListDF_6488, function(x){
getBigPlot(x)
})
pdf(file = "../figures/Fig5_temp.pdf",
width = 8, height = 8)
listBigPlot_6488$full
dev.off()
table(conta$infection_isolate)
168-118
16+12
DSart2[DSart2$anth == F & !DSart2$EH_ID %in% conta$EH_ID,]
makeSummaryTable(DSart2[DSart2$anth == F & !DSart2$EH_ID %in% conta$EH_ID,])
nrow(makeSummaryTable(DSart2[DSart2$anth == F & !DSart2$EH_ID %in% conta$EH_ID,]))
nrow(makeSummaryTable(DSart2[DSart2$anth == T,]))
nrow(makeSummaryTable(DSart2$EH_ID %in% conta$EH_ID,]))
nrow(makeSummaryTable(DSart2[DSart2$EH_ID %in% conta$EH_ID,]))
28+22
nrow(makeSummaryTable(DSart2[DSart2$anth == T,]))
